(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69],{2975:(e,t,a)=>{Promise.resolve().then(a.bind(a,5460))},5460:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(5155),r=a(2115);class c{async searchCities(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a="city:".concat(e,":").concat(t);if(console.log("Searching cities for:",e),this.cache.has(a))return console.log("Using cached result for:",e),this.cache.get(a);try{let s=new URLSearchParams({name_startsWith:e,maxRows:t.toString(),username:"oktamov_shohjahon",featureClass:"P"}),r="".concat("http://api.geonames.org/searchJSON","?").concat(s);console.log("Calling GeoNames API:",r);let c=await fetch(r,{headers:{Accept:"application/json"}});if(!c.ok)throw Error("GeoNames API error: ".concat(c.status));let o=await c.json();if(console.log("GeoNames response:",o),Array.isArray(o.geonames)){let t=o.geonames.map(e=>({place_id:e.geonameId,display_name:"".concat(e.name).concat(e.adminName1?", "+e.adminName1:"").concat(e.countryName?", "+e.countryName:""),lat:e.lat,lon:e.lng,type:e.fcodeName,address:{city:e.name,state:e.adminName1,country:e.countryName}})),s={suggestions:t};return this.cache.set(a,s),console.log("Found",t.length,"cities for:",e),s}return{suggestions:[]}}catch(e){return console.error("Error searching cities:",e),{suggestions:[],error:"Failed to search cities"}}}async searchStreets(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s="street:".concat(e,":").concat(t,":").concat(a);if(this.cache.has(s))return this.cache.get(s);try{let r=new URLSearchParams({q:t?"".concat(e,", ").concat(t):e,format:"json",addressdetails:"1",limit:a.toString(),featuretype:"street"}),c=await fetch("".concat("https://nominatim.openstreetmap.org/search","?").concat(r),{headers:{Accept:"application/json","User-Agent":"ProKvartiru/1.0"}});if(!c.ok)throw Error("HTTP error! status: ".concat(c.status));let o={suggestions:(await c.json()).map(e=>({place_id:e.place_id,display_name:e.display_name,lat:e.lat,lon:e.lon,type:e.type,address:e.address||{}}))};return this.cache.set(s,o),o}catch(e){return console.error("Error searching streets:",e),{suggestions:[],error:"Failed to search streets"}}}async reverseGeocode(e,t){try{let a=new URLSearchParams({lat:e,lon:t,format:"json",addressdetails:"1"}),s=await fetch("".concat("https://nominatim.openstreetmap.org/reverse","?").concat(a),{headers:{Accept:"application/json","User-Agent":"ProKvartiru/1.0"}});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let r=await s.json();return{place_id:r.place_id,display_name:r.display_name,lat:r.lat,lon:r.lon,type:r.type,address:r.address||{}}}catch(e){return console.error("Error reverse geocoding:",e),null}}clearCache(){this.cache.clear()}getCacheSize(){return this.cache.size}constructor(){this.cache=new Map}}let o=new c;function n(){let[e,t]=(0,r.useState)(""),[a,c]=(0,r.useState)([]),[n,i]=(0,r.useState)(!1),l=async()=>{if(e.trim()){i(!0);try{let t=await o.searchCities(e,10);console.log("Test result:",t),c(t.suggestions||[])}catch(e){console.error("Test error:",e),c([])}finally{i(!1)}}};return(0,s.jsxs)("div",{className:"p-8 max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Geocoding API Test"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter city name...",className:"border p-2 rounded w-full max-w-md"})}),(0,s.jsx)("button",{onClick:l,disabled:n,className:"bg-blue-500 text-white px-4 py-2 rounded disabled:opacity-50",children:n?"Searching...":"Search Cities"}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("h2",{className:"text-lg font-semibold mb-3",children:["Results (",a.length,")"]}),(0,s.jsx)("div",{className:"space-y-2",children:a.map((e,t)=>(0,s.jsxs)("div",{className:"border p-3 rounded",children:[(0,s.jsx)("div",{className:"font-medium",children:e.display_name}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Type: ",e.type," | Lat: ",e.lat," | Lon: ",e.lon]}),e.address&&(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Address: ",JSON.stringify(e.address)]})]},t))})]})]})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=2975)),_N_E=e.O()}]);